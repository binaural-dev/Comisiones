<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_payslip_binaural" inherit_id="hr_payroll.report_payslip">
        <table name="employee-infos" position="replace">
            <table name="employee-infos" class="table table-sm table-bordered">
                <tr>
                    <td class="w-25"><strong>Empleado</strong></td>
                    <td class="w-25"><strong>Cédula de Identidad</strong></td>
                    <td class="w-25"><strong>Departamento</strong></td>
                    <td class="w-25"><strong>Cargo</strong></td>
                </tr>
                <tr>
                    <td><span t-field="o.employee_id"/></td>
                    <td>
                        <span t-field="o.employee_id.prefix_vat"/>
                        <span t-field="o.employee_id.vat"/>
                    </td>
                    <td><span t-field="o.employee_id.department_id"/></td>
                    <td><span t-field="o.employee_id.job_title"/></td>
                </tr>
                <tr>
                    <td class="w-25"><strong>Fecha de Ingreso</strong></td>
                    <td class="w-25"><strong>Período de Pago</strong></td>
                    <td><strong>Calculado en </strong></td>
                </tr>
                <tr>
                    <td><span t-field="o.employee_id.entry_date"/></td>
                    <td><span t-field="o.date_from"/> - <span t-field="o.date_to"/></td>
                    <td><span t-field="o.compute_date"/></td>
                </tr>
            </table>
        </table>

        <xpath expr="//thead[@class='o_black_border']" position="replace">
            <thead class="o_black_border">
                <tr>
                    <th>Nombre</th>
                    <th>Número de horas</th>
                    <th>Número de días</th>
                    <th>Asignaciones</th>
                    <th>Deducciones</th>
                </tr>
            </thead>
        </xpath>

        <xpath
            expr="//span[@t-foreach='o.worked_days_line_ids']//tr[@style='color:none']"
            position="replace"
        >
            <tr style="color:none">
                <td><span t-field="worked_days.name"/></td>
                <td><span t-field="worked_days.number_of_hours"/></td>
                <td><span t-field="worked_days.number_of_days"/></td>
                <td></td>
                <td></td>
            </tr>
        </xpath>

        <xpath
            expr="//span[@t-foreach='o.line_ids.filtered(lambda line: line.appears_on_payslip)']//tr[@t-att-class='line_class']"
            position="replace"
        >
            <tr t-att-class="line_class" t-att-style="line_style" t-if="bool(line.total)">
                <td><span t-field="line.name"/></td>
                <td>
                    <t t-if="line.is_a_hours_line">
                        <span t-esc="line.amount"/>
                    </t>
                </td>
                <td>
                    <t t-if="line.is_a_days_line">
                        <span t-esc="line.amount"/>
                    </t>
                </td>
                <td>
                    <t t-if="not line.is_a_days_line and not line.is_a_hours_line">
                        <span
                            t-if="line.total &gt; 0"
                            t-esc="line.total"
                            t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'
                        />
                    </t>
                </td>
                <td>
                    <t t-if="not line.is_a_days_line and not line.is_a_hours_line">
                        <span
                            t-if="line.total &lt; 0"
                            t-esc="line.total"
                            t-options='{"widget": "monetary", "display_currency": o.company_id.currency_id}'
                        />
                    </t>
                </td>
            </tr>
        </xpath>

        <xpath expr="//div[@id='total']/following-sibling::p[1]" position="replace">
            <p 
                t-if="o.net_wage &gt;= 0 and o.employee_id.default_account_bank_id"
                id="total-to-pay-on-account"
            >
                Total a pagar en
                <span t-field="o.employee_id.default_account_bank_id"/>
                (
                    <span t-field="o.employee_id.default_account_bank_id.bank_name"/>, 
                    Cuenta <span t-field="o.employee_id.default_account_bank_id.account_type"/>
                ).
            </p>
        </xpath>

        <xpath expr="//table[@name='contract-infos']" position="replace">
        </xpath>

        <xpath expr="//div[@class='page']//p[@class='text-center']" position="before">
            <br/>
            <br/>
            <p
                style="text-align: center; border-top: 1px solid #212121; padding-top: 10px"
                class="w-100"
            >Recibo conforme, CI: <span t-field="o.employee_id.vat"></span></p>
        </xpath>

        <xpath expr="//div[@class='page']//p[@class='text-center']" position="replace">
            <p class="text-center">Hecho por Binaural</p>
        </xpath>
    </template>

    <template id="report_payslip_lang_binaural" inherit_id="hr_payroll.report_payslip_lang">
        <xpath expr="//t[@t-foreach='docs']" position="replace">
            <t t-foreach="docs" t-as="o">
                <t t-set="inside_foreach_docs" t-value="o"/>
                <t t-call="hr_payroll.report_payslip" t-lang="user_lang"/>
            </t>
        </xpath>
    </template>
</odoo>
